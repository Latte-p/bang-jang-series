### 3. 키 배송 문제를 해결한 암호

#### 키 문제를 해결한 "공개키 암호"
- 공개 키 암호 방식
  - 공통키(대칭키) 암호에서 "키를 어떻게 전달해야 하나", "대량의 키를 어떻게 관리해야 하나?" 등의 문제점을 해결한 암호 방식
  - 암호화 및 복호화에 다른 키를 사용하기 때문에 비대칭 암호라고도 함
  - 암호화 및 복호화에서 사용되는 키는 다른 키라고 해도 각각이 독립적인 것이 아니라 쌍을 이루고 있다.
  - 하나는 공개키라고 하여 3자에게 공개 되어도 상관이 없다
  - 다른 하나는 비밀 키라고 하여 본인 이외에 절대 알려져선 않도록 해야 한다.
- 공개키 암호 방식 예시
  1. A씨가 B씨에게 데이터를 송신할 때, B씨는 한 쌍의 공개키와 비밀키를 준비하여 공개키는 공개를 한다.
  2. A씨는 B씨의 공개키를 사용하여 데이터를 암호화 하고 암호문을 B씨에게 보낸다.
  3. B씨는 수신된 암호문을 B씨가 가진 비밀키로 복호화 하여 원래의 데이터를 얻어낼 수 있다.
  4. 이 떄 비밀키는 B씨 밖에 모르기 때문에 암호문이 제 3자에게 도청되어도 복호화 되는 것은 아니다.

#### 공개키 암호의 장점과 단점
- 장점
  - 공개키 암호에서 필요한 키는 2개이기 따문에 통신 상대방의 수가 늘어나도 준비하는 키가 늘어나는 것이 아니다.
  - 암호문을 교환하는 경우 수신자가 공개키를 공개하면 되기 때문에, 공통키 암호처럼 '키를 어떻게 전달해야 할까'라는 문제또한 발생하지 않는다.
- 단점
  - 공개키 암호는 대칭키 암호에 비해 복잡한 계산식을 사용한다. 따라서 부하(시스템의 연산)가 많이 발생하므로 커다란 파일에 대한 암호화에는 적합하지 않다.
  - 또한 애초에 공개키를 공개한 상대가 본인임을 증명하는 인증기관과 인증서가 필요하다.
  - 중간자 공격의 우려 또한 존재한다.

#### Point
- 공개 키 암호는 통신 상대방이 늘어나도 관리해야 한느 키의 숫자가 증가하지 않고, 키의 배송 문제도 해결하였다.
- 공개키 암호는 공개키를 발행한 상대가 본인임을 증명하기 위해 인증기관과 인증서가 필요하다.


### 4. 공개 키 암호를 지원하는 기술
#### 올바른 상대임을 증명하는 "인증서" "인증기관" "PKI"
- 공개 키 암호는 공개된 키가 적법한 상대방의 키라는 보장이 없다는 불안감이 있다.
- A씨가 B씨를 사칭하여 B의 공개키를 공개해도 그것이 올바른 것인지 판단할 수 없다.
- 공개키와 비밀키를 생성하는 것은 자유이므로 B씨를 사칭할 수 있는 것.
- 실제 사회에서도 다른 사람을 사칭하여 인감을 생성하면 그 인감이 본인의 것인지 판단할 수 없다.
- 그러나 인감의 경우에는 공공기관에 인감 등록을 해두면, 인감 인증서를 통해 본인의 것임을 확인할 수 있다.
- 공개 키 암호도 마찬가지로 공개키를 관리하는 인증기관에 의해 "적법한 상태방이다" 라는 인증서가 발급되면 안심하고 거래할 수 있다.
- 이 기관을 인증기관(Certificate Authority : CA)이라고 부르며, 이러한 인증의 기반이 되는 것은 PKI(Public Key Infrastructure : 공개 키 기반)이다.

#### 인증기관과 인증서의 신뢰성을 확인하는 방법
- 인증기관은 누구나 만들 수 있으므로 공격자가 임의로 만든 인증 기관인 경우 신뢰할 수 없게 된다.
- 그래서 신뢰할 수 있는 인증기관에서 발급된 인증서임을 확인하기 위해 인증서 체인이 사용된다.
- 인증서 체인은 인증경로 라고 불리며, 해당 인증서를 발행한 인증 기관을 차례로 확인하여 신뢰할 수 있는 인증기관까지 도달할 수 있는지 여부를 확인하기 위해 사용된다.
- 발급된 인증서에 포함된 인증기관의 디지털 서명을 순서대로 확인하여 최상위 인증기관에 도달할 수 있는지 확인한다.
- 최상위에 해당하는 인증서를 루트 인증서라고 한다.
- 웹사이트를 조회할 때 사용되는 루트 인증서는 웹 브라우저를 설치할 때 자동으로 설치되어 있다.
- 웹 사이트의 경우 전송대상 웹 서버에 미리 서버 인증서를 배치해 놓음으로써 그 웹서버가 신뢰할 수 있는지 여부를 확인한다.

#### 인증 기관에 의한 인증서 발행
1. 서명자가 등록기관에 신청
2. 등록기관은 신청한 서명자에 대한 심사 진행
3. 인증기관(CA)에 보고
4. 인증키를 특정 레퍼지토리에 정해서 인증서 발급

#### Point
- 인증기관에서 발급한 인증서에 의해 본인의 것임을 증명할 수 있다.
- 신뢰할 수 있는 인증기관임을 확인하기 위해서 루트 CA 인증서로부터 연결되어온 인증서 체인을 검증한다.


### 5. 위, 변조 검출에 사용되는 기술(해시, Hash)
#### 내용이 바뀌면 값이 큰 폭으로 변하는 해시
- 데이터의 송수신 처리 작업이 성공적으로 완료되었어도, 통신 경로에서 위, 변조가 발생했다면 큰 문제가 된다.
- 또한 수신된 데이터가 손상 되었다면 그 이후에 수행되어야 하는 처리가 진행되지 않는다.
- 따라서 전송된 데이터와 수신된 데이터가 동일하다는 것을 확인할 필요가 있다.
- 이러한 필요에 의해 사용되는 것이 해시(Hash)이며, 해시를 구하기 위해 수행하는 처리를 해시함수, 구해진 값을 해시 값 이라고 한다.
- 해시는 다음과 같은 특징이 있다.
  - 해시함수를 적용한 결과물로부터 원본 메시지를 추정할 수 없다.
  - 메시지의 길이에  관게 없이 해시 값의 길이는 일정하다.
  - 동일한 해시 값이 나타나는 다른 메시지를 만들어 낼 수 없다.
- 전송된 데이터와 비교하여 내용이 조금이라도 변화되었다면 해시 값은 큰 폭으로 바뀐다.
- 따라서 수신된 데이터의 해시 값을 비교하면 동일한 데이터인지 여부를 확인할 수 있다.

#### 해시의 활용방법
- 예시1) 
  - 웹사이트에서 다운로드한 파일이 손상되지 않았는지 확인하는 용도
  - 다운로드한 파일과 함꼐 그 파일의 해시 값을 공개함으로써 다운로드한 사람은 올바른 파일이 다운로드 되었는지를 확인할 수 있다.
- 예시2)
  - 패스워드를 저장하는 용도
  - 관리자는 입력한 패스워드를 그대로 보관하는 것이 아닌 해시값으로 저장하고, 로그인 시 암호 대신해서 해시값을 비교하여 로그인 처리를 한다.
  - 해시값이 유출되어도 패스워드는 해시값을 통해 알아낼 수 없기 때문에 유출로 인한 위험을 줄일 수 있다.

#### +추가
- 해시
  - 해시 함수에 의해 나온 값(해시값, 해시코드, 체크섬)
- 해시 함수
  - 해시 알고리즘 또는 해시 함수 알고리즘 이라고 함
  - 임의의 길이의 데이터를 고정된 길이의 데이터로 바꾸는 함수
  - 큰 파일에서 중복되는 데이터를 찾을 수 있기 때문에 데이터베이스 검색이나 테이블 검색을 가속화 할 수 있다.
  - 용도 중 하나가 해시테이블이라는 자료구조에 사용
  - 암호학적에서 해시함수는 MD5, SHA계열 해시함수를 사용

#### Point
- 해시 값을 비교함으로써 데이터가 위, 변조되지 않았다는 것을 확인할 수 있다.
- 패스워드를 보관할 때 해시 값을 사용하면, 유출로 인하여 발생되는 위험을 줄일 수 있다.
