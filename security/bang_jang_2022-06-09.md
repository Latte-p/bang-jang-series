### 8. 공격을 어디에서 막을까? (입구대책, 출구대책, 심층방어)
#### 공격의 4가지 대책
- 바이러스를 사용하는 공격에는 다음의 4가지 단계가 있다.
  1. 침입 : 회사 내부의 PC에 바이러스를 감염시킨다
  2. 확대 : 회사 내부 네트워크에서 감염된 PC를 증가시킨다/
  3. 조사 : 기밀 정보를 가지고 있을 것 같은 PC나 서버를 찾는다.
  4. 취득 : 기밀 정보를 추출하여 외부로 보낸다.
- 이러한 단계를 어딘가에서 차단하면 심각한 피해가 나오기 전에 처리가 가능하다.
- 가장 먼저 생각해야 하는 것은 입구 대책이다.
  - "바이러스의 침입을 방지한다.", "침입이 되어도 감염되지는 않는다."라는 대책이 세워져 있으면 이상적이다.
  - 하지만 표적 형태의 공격 등을 생각할 때 바이러스 백신 소프르웨어와 방화벽 만드로 침입을 완전히 방지하는 것은 어렵다.
- 그래서 정보의 파괴나 누설, 타인에 대한 공격 등을 일으키지 않도록 대책을 마련해야 한다.
- 예를들어, 네트워크를 분리하여 피해의 확산 범위를 제한하거나, 관리자 권한을 최소로 하거나 파일 공유를 제한하는 것 등은 대책으로서 효과가 있다.
- 또한 외부로 기밀 정보가 전송되지 않도록 하거나, 전송되어도 영향을 받지 않게 하는 생각이 출구 대책이다.
- 업무가 정지되는 상황이 발생한다고 해도, 밖으로 확대되지 않고 회사 내부로만 범위가 국한된다면, 피해를 최소화할 수 있다.
```
바이러스 감염으로부터 정보 유출까지 흐름
1. 바이러스에 감염
2. 사내 네트워크를 통해 확산
3. 기밀 정보를 조사
4. 취득한 정보를 외부로 전송
```

#### 여러 대책을 조합하여 효과를 높인다.
- 입구 대책이나 출구 대책을 수행하는 것은 바이러스 감염에 대한 대응만은 아니다.
- 웹 어플리케이션 프로그램을 제공하는 기업인 경우, 외부로부터 공격을 받을 수 있다.
- 이때 1개의 대책이 아닌 여러 대책을 조합하는 것은 심층 방어라고 한다.
- 공격을 막는 효과를 높여주는 것 이외에도 공격에 대응하기 위한 시간을 확보해주는 효과가 있다.

```
심층 방어의 예

방화벽
- 포트번호 80번, 43번 이외에 차단
--> 인터넷 접속시 사용되는 http가 80 https가 443 이라고 생각하심됩니다.

IPS(침입방지 시스템)
- 이미 알려진 공격 패턴을 차단

WAF(웹 애플리케이션 방화벽)
- 정의가 쉬운 XSS, SQL Injection 차단
--> 4장에서 자세히 다룹니다.

웹서버
- OS나 미들웨어에 패치를 적용

어플리케이션서버
- 취약점을 제거

DB서버
- 정상적인 통신만

```

### Point
- 표적 공격의 수법이 증가하고 있기 때문에, 입구 대책 뿐만 아니라 출구 대책도 필요하다.
- 외부로부터 공격을 막기 위해 여러 대책을 조합한 심층 방어가 효과적이다.

### 9. 부정 접속 대책의 기본(방화벽, 패킷 필터링)
#### 인터넷과 내부 네트워크를 분할
- 인터넷과 내부 네트워크의 경계에 설치하여 회사 네트워크의 문지기 역할을 하는 네트워크 장비를 방화벽 이라고 한다.
- 인터넷과 내부 네트워크 사이에 교환되는 통신 데이터를 모니터링 하고 미리 정한 규칙에 따라 데이터의 전송을 허용할 지 여부를 결정한다.
- 이 때 외부로부터의 통신 차단 뿐만 아니라 외부로 나가는 통신도 차단할 수 있다.
- 방화벽 기능은 제품에 따라 다르다.
  - 통신의 도착지(통신이 도착하는 곳)정보만 보고 가부를 판단하는 제품
  - 통신의 내용까지 자세히 검서하는 제품도 있다.
- 그러나 통과하는 전자메일의 내용까지 방화벽이 알 수 없기 때문에 바이러스를 다운로드하거나, 메일에 첨부되어 있는 경우에 통과되어 버린다.
- 별도의 바이러스 백신 소프트웨어를 사용해야 하는 필요성이 여기에 있다.

#### 필요한 패킷만 통과시킨다.
- 패킷 필터링은 송신자와 수신자의 IP주소와 포트(Port) 번호를 확인해서 통신을 제어하는 기능이다.
- 예를들어 회사의 특정 서버에만 외부로부터 통신이 허용되는 경우에는 통신상의 수신처가 해당 서버로 기술되어 있는 통신만 허용된다.
- 마찬가지로 내부에 특정 컴퓨터만 외부와 통신할 수 있도록 하려면 송신자의 IP주소를 확인해서 통신을 허용한다.
- 특정 통신을 허용하기 위해서는 IP 주소 뿐만 아니라, HTTP나  HTTPS등 프로토콜 단위로 제어할 수 있다.
- 예를들어 HTTP의 경우 포트 번호로 80번, HTTPS의 경우 443번만 허용하는 설정이 가능하다.

#### Point
- 부정 접속을 방지하기 위해 정해진 규칙에 따라 통신을 차단하는 방화벽이 사용된다.
- 방화벽에서는 패킷 필터링(Packet FIltering)기능을 이용하여 통신 내용을 제어한다.

### 10. 통신 모니터링 및 분석(패킷 캡쳐)
#### 패킷 캡쳐로 통신 내용을 감시
- 네트워크 상에서 흘러 다니는 통신 내용을 확인하기 위해 패킷을 수집하는 것을 패킷 캡쳐라고 한다.
- 네트워크에 문제가 발생한 경우에는 조사를 위해 사용되기도 하며, 의심스러운 통신이 이루어지고 있지 않은지 확인하기 위한 용도로 사용되는 경우도 있다.
- 패킷 캡쳐를 하는 방법은 
  - "사용하고 있는 컴퓨터 송수신 되는 패킷을 조사하는 빙법"
  - "리피터 허브나 일부 스위칭 허브를 흘러다니는 패킷을 조사하는 방법"
```
리피터 허브
- 여러가지 포트를 가지고 있는 네트워크 장비로, 
어떤 포트로부터 입력된 신호를 모든 포트에 전달한다.

스위칭 허브
- 필요한 포트를 한정하여 신호를 전달하지 않지만 일부는
미러링 포트라는 포트를 보유하고 있다.
- 미러링 포트를 보유한 허브에 접속하면 해당 스위칭 허브에 연결된
다른 컴퓨터 통신을 볼 수 있다.
```
- 최근엔 리피터 허브가 거의 사용되지 않기 떄문에 일반적으로 스위칭 허브의 미러링 포트를 사용

#### 무료 도구로 캡처(Capture)가능하다.
- 패킷 캡쳐 도구로 많이 사용되고 있는 것이 Wireshark이다.
- 오픈소스로 개발되어 있어서 누구나 무료로 이용할 수 있고, 다양한 OS를 지원하고 있다.
- Wireshark 공식사이트(https://www.wireshark.org/)에 접속하면 사용하고 있는 컴퓨터의 OS에 맞는 최신 버전을 다운로드 할 수 있다.
- Wireshark를 이용하면 패킷을 캡쳐할 수 있을 뿐만 아니라 통신에 대한 다양한 분석이 가능하다.
- 예를들면 통신에 사용된 프로토콜의 종류와 비율을 집계하는 것이 가능하다.

#### Point
- 패킷 캡처에 의해 네트워크를 흘러 다니고 있는 패킷을 조사할 수 있다.
- 자주 사용되는 패킷 캡쳐도구로 Wireshark가 있으며, 무료로 사용할 수 있다.
